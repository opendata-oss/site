---
import DocsLayout from '../../layouts/DocsLayout.astro';
import CodeBlock from '../../components/CodeBlock.astro';
import TodoBadge from '../../components/TodoBadge.astro';

const toc = [
  { label: 'Overview', id: 'overview', level: 2 },
  { label: 'Use Cases', id: 'use-cases', level: 3 },
  { label: 'Quickstart', id: 'quickstart', level: 2 },
  { label: 'API Reference', id: 'api-reference', level: 2 },
  { label: 'Configuration', id: 'configuration', level: 2 },
  { label: 'Operations', id: 'operations', level: 2 },
  { label: 'Performance', id: 'performance', level: 2 },
  { label: 'Comparisons', id: 'comparisons', level: 2 },
];

const startCode = `<span class="text-[#6c7086]"># Start OpenData Vector</span>
<span class="text-[#a6e3a1]">$</span> docker run -p 8082:8080 \\
    -e OPENDATA_STORAGE_BACKEND=s3 \\
    -e OPENDATA_STORAGE_BUCKET=my-opendata-bucket \\
    opendata/vector:latest`;

const usageCode = `<span class="text-[#6c7086]"># Create a collection</span>
<span class="text-[#a6e3a1]">$</span> curl -X POST http://localhost:8082/v1/collections \\
    -H "Content-Type: application/json" \\
    -d '<span class="text-[#f9e2af]">{"name": "documents", "dimension": 768, "metric": "cosine"}</span>'

<span class="text-[#6c7086]"># Insert vectors</span>
<span class="text-[#a6e3a1]">$</span> curl -X POST http://localhost:8082/v1/collections/documents/vectors \\
    -H "Content-Type: application/json" \\
    -d '<span class="text-[#f9e2af]">{"vectors": [{"id": "doc-1", "values": [0.1, 0.2, ...], "metadata": {"title": "Hello World"}}]}</span>'

<span class="text-[#6c7086]"># Search</span>
<span class="text-[#a6e3a1]">$</span> curl -X POST http://localhost:8082/v1/collections/documents/search \\
    -H "Content-Type: application/json" \\
    -d '<span class="text-[#f9e2af]">{"vector": [0.1, 0.2, ...], "top_k": 10}</span>'`;
---

<DocsLayout
  title="Vector &mdash; OpenData"
  description="OpenData Vector: SPANN-style ANN search built on object storage."
  toc={toc}
  breadcrumbs={[
    { label: 'Databases', href: '/databases/log' },
    { label: 'Vector' },
  ]}
>
  <div class="flex items-center gap-3 mb-2">
    <span class="flex items-center justify-center w-10 h-10 rounded-lg bg-db-vector text-white text-lg">&#x1F9ED;</span>
    <h1 class="text-3xl font-bold">Vector</h1>
  </div>
  <p class="text-text-secondary text-lg mb-8">
    SPANN-style approximate nearest neighbor search for embeddings and AI applications.
    Durable, scalable, and built on object storage.
  </p>

  <h2 id="overview">Overview</h2>

  <p>
    OpenData Vector is a vector database for approximate nearest neighbor (ANN) search,
    built natively on object storage. It uses the SPANN algorithm for efficient
    high-dimensional similarity search, making it ideal for AI/ML applications that
    need to search across millions of embeddings.
  </p>

  <h3 id="use-cases">Use Cases</h3>

  <ul>
    <li><strong>Semantic search</strong> &mdash; Find similar documents, images, or products using embedding vectors</li>
    <li><strong>RAG pipelines</strong> &mdash; Retrieval-augmented generation for LLM applications</li>
    <li><strong>Recommendation systems</strong> &mdash; Find similar items based on feature vectors</li>
    <li><strong>Anomaly detection</strong> &mdash; Identify outliers by distance from normal patterns</li>
  </ul>

  <p>
    <strong>Key differentiators:</strong> No separate index service to manage (index lives in object storage),
    decoupled compute for cost-efficient scaling, shared operational model with all OpenData databases.
  </p>

  <h2 id="quickstart">Quickstart</h2>

  <div class="my-4">
    <CodeBlock title="terminal" code={startCode} />
  </div>

  <p>Create a collection and insert vectors:</p>

  <div class="my-4">
    <CodeBlock title="terminal" code={usageCode} />
  </div>

  <h2 id="api-reference">API Reference</h2>

  <table>
    <thead>
      <tr>
        <th>Method</th>
        <th>Path</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>POST</code></td>
        <td><code>/v1/collections</code></td>
        <td>Create a collection</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/v1/collections</code></td>
        <td>List collections</td>
      </tr>
      <tr>
        <td><code>DELETE</code></td>
        <td><code>/v1/collections/&#123;name&#125;</code></td>
        <td>Delete a collection</td>
      </tr>
      <tr>
        <td><code>POST</code></td>
        <td><code>/v1/collections/&#123;name&#125;/vectors</code></td>
        <td>Insert or upsert vectors</td>
      </tr>
      <tr>
        <td><code>POST</code></td>
        <td><code>/v1/collections/&#123;name&#125;/search</code></td>
        <td>Search for nearest neighbors</td>
      </tr>
      <tr>
        <td><code>GET</code></td>
        <td><code>/v1/collections/&#123;name&#125;/vectors/&#123;id&#125;</code></td>
        <td>Get a vector by ID</td>
      </tr>
      <tr>
        <td><code>DELETE</code></td>
        <td><code>/v1/collections/&#123;name&#125;/vectors/&#123;id&#125;</code></td>
        <td>Delete a vector</td>
      </tr>
    </tbody>
  </table>

  <div class="my-4">
    <TodoBadge label="TODO: Detailed API reference with request/response examples" />
  </div>

  <h2 id="configuration">Configuration Reference</h2>

  <table>
    <thead>
      <tr>
        <th>Config Key</th>
        <th>Type</th>
        <th>Default</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>storage.backend</code></td>
        <td>string</td>
        <td><code>local</code></td>
        <td>Storage backend: <code>local</code>, <code>s3</code>, <code>gcs</code>, <code>azure</code></td>
      </tr>
      <tr>
        <td><code>storage.bucket</code></td>
        <td>string</td>
        <td>&mdash;</td>
        <td>Object storage bucket name</td>
      </tr>
      <tr>
        <td><code>index.num_partitions</code></td>
        <td>integer</td>
        <td><code>256</code></td>
        <td>Number of SPANN partitions</td>
      </tr>
      <tr>
        <td><code>index.num_candidates</code></td>
        <td>integer</td>
        <td><code>128</code></td>
        <td>Number of candidate partitions to search</td>
      </tr>
      <tr>
        <td><code>cache.size_mb</code></td>
        <td>integer</td>
        <td><code>512</code></td>
        <td>Local cache size in MB</td>
      </tr>
    </tbody>
  </table>

  <div class="my-4">
    <TodoBadge label="TODO: Complete configuration reference" />
  </div>

  <h2 id="operations">Operational Guide</h2>

  <div class="my-6 rounded-xl bg-accent/5 border border-accent/20 px-5 py-4">
    <p class="text-sm text-text-secondary leading-relaxed">
      <span class="font-semibold text-text">Shared operational model:</span> These operational
      procedures are shared across all OpenData databases. See the
      <a href="/databases/log#operations" class="text-accent hover:underline">Log operational guide</a>
      for full details &mdash; the same patterns apply here.
    </p>
  </div>

  <div class="my-4">
    <TodoBadge label="TODO: Vector-specific operational details" />
  </div>

  <h2 id="performance">Performance &amp; Benchmarks</h2>

  <div class="my-6 rounded-xl border border-border p-6 bg-surface-alt">
    <div class="flex items-center gap-2 mb-3">
      <TodoBadge label="TODO: Benchmarks coming soon" />
    </div>
    <p class="text-sm text-text-secondary">
      We test OpenData Vector against Pinecone and Qdrant on the following workloads:
    </p>
    <ul class="mt-3 space-y-1 text-sm text-text-secondary">
      <li>&#x2022; ANN recall at various top-k values</li>
      <li>&#x2022; Query latency (p50, p99)</li>
      <li>&#x2022; Index build time</li>
      <li>&#x2022; Filtered search performance</li>
    </ul>
  </div>

  <h2 id="comparisons">Comparisons</h2>

  <div class="my-6 rounded-xl border border-border p-6 bg-surface-alt">
    <div class="flex items-center gap-2 mb-3">
      <TodoBadge label="TODO: Comparison pages" />
    </div>
    <ul class="space-y-2 text-sm text-text-secondary">
      <li>&#x2022; <strong>OpenData Vector vs Pinecone</strong></li>
      <li>&#x2022; <strong>OpenData Vector vs Qdrant</strong></li>
      <li>&#x2022; <strong>OpenData Vector vs Milvus</strong></li>
      <li>&#x2022; <strong>OpenData Vector vs Weaviate</strong></li>
    </ul>
  </div>
</DocsLayout>
